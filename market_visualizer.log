2024-11-09 13:48:40,233 - __main__ - INFO - Starting visualization process...
2024-11-09 13:48:40,233 - __main__ - INFO - Initializing MarketVisualizer with data from data/raw/btc_usdt_1m_processed.csv
2024-11-09 13:48:40,233 - __main__ - INFO - Loading and preprocessing market data...
2024-11-09 13:48:47,783 - __main__ - INFO - Converting data to numeric format...
2024-11-09 13:48:47,899 - __main__ - INFO - Analysis dataframe shape: (2555592, 9)
2024-11-09 13:48:47,899 - __main__ - INFO - Creating sequences for scaler fitting...
2024-11-09 13:48:47,967 - __main__ - INFO - Created 2556 sequences of shape (60, 9)
2024-11-09 13:48:47,967 - __main__ - INFO - Fitting scalers...
2024-11-09 13:48:47,983 - __main__ - INFO - Scalers fitted successfully
2024-11-09 13:48:47,983 - __main__ - INFO - Created output directory: visualizations
2024-11-09 13:48:47,983 - __main__ - INFO - Creating market overview visualization...
2024-11-09 13:48:47,983 - __main__ - INFO - Creating market overview for last 30 days
2024-11-09 13:48:48,274 - __main__ - INFO - Market overview plot created successfully
2024-11-09 13:48:48,693 - __main__ - INFO - Creating hypersphere visualization...
2024-11-09 13:48:48,693 - __main__ - INFO - Creating hypersphere visualization using pca
2024-11-09 13:48:48,694 - __main__ - INFO - Encoding 1000 market states...
2024-11-09 13:48:48,869 - __main__ - INFO - Processing encoded states...
2024-11-09 13:48:48,870 - __main__ - ERROR - Error creating visualizations: Can't call numpy() on Tensor that requires grad. Use tensor.detach().numpy() instead.
Traceback (most recent call last):
  File "C:\Users\dylan\Desktop\sheeplz-crypto-bot\viz.py", line 281, in main
    hypersphere_fig_pca = viz.visualize_hypersphere(projection_method='pca')
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dylan\Desktop\sheeplz-crypto-bot\viz.py", line 218, in visualize_hypersphere
    encoded_states = torch.stack(states).numpy()
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Can't call numpy() on Tensor that requires grad. Use tensor.detach().numpy() instead.
